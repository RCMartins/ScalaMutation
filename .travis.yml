language: scala
scala:
  - 2.12.8
before_install:
  - git fetch --tags
before_script:
  - sudo sh -c '(echo "#!/usr/bin/env sh" && curl -L https://github.com/lihaoyi/Ammonite/releases/download/1.6.9/2.12-1.6.9) > /usr/local/bin/amm && chmod +x /usr/local/bin/amm'
jobs:
  include:
  - stage: pull request testing
    name: running unit tests
    if: type = pull_request
    script: sbt clean tests/test coverageReport codacyCoverage

  - name: formatting check
    if: type = pull_request
    script: sbt scalafmtCheckAll scalafmtSbtCheck

  - stage: release
    if: ((branch = master AND type = push) OR (tag IS present)) AND NOT fork
    script: sbt ci-release
cache:
  directories:
  - "$HOME/.ivy2/cache"
  - "$HOME/.sbt/boot/"
  - "$HOME/.coursier/cache"
env:
  global:
    secure: hhERLT6aS80lQY5Ot0/Fwtqa+iZBfPU+iBkakB7kS89JRIAD3fFaUjqZfaqfDyM79hKNEbuBZt6X4EsQBzduoC+RTqy0GFQRsLF50Ptxr8Jzhx0SDi1o+l6uG6ZvSrRmlZ/03pnC5YGZvSE5H1CFSfj09kAOoPzPw6HuVR8WnhuKqFWx/bMhdy2TM0Nx8W/KdPnRzFzKb4rjsVCINwsdsBDLb1014QFiT8mFgLtyCTfxGzdkDy+tjM7jyg2m3JortuVl5pAn9ErOaDq0X5PHDcORoPiVJE+fd3DNRnazqbIS9+ZuBA7L707V15h0m+c8xJWNGB8+GcoKX9RXA1lsOS2egxzY6xCpystYioeNM7CxuPrUi2mq0I3dpx8u/5X+6YE280dBh48OqD4Nnyp9rS9XQMFyBfMVwZWzYDpU1dxO2cegbgRC2EhxcQZpudiixgImSmx/8tGrYnHL/KiU/hHZaGwVBRVFXeEMmsFBi1GZ6QuAjPTR8/omfb+LH3z59q/Ohz7t4BpFGb1P3guG9KsOeM/S6V8QVmluitCmY34JOXbye4VurmzbXHsv9XaUJ7BD2HGhGzpZgxUKWkwgcc9kmttMzbTtQY6DTiAGU5qDLKDYWnxJ3Fo98iYgNo1yPfnUqDCF7VSVYgstHxfcCjaooYTIu5ed85cGYQrAC9I=
