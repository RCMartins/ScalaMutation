language: scala
scala:
  - 2.12.8
before_install:
  - git fetch --tags
before_script:
  - sudo sh -c '(echo "#!/usr/bin/env sh" && curl -L https://github.com/lihaoyi/Ammonite/releases/download/1.6.9/2.12-1.6.9) > /usr/local/bin/amm && chmod +x /usr/local/bin/amm'
jobs:
  include:
  - stage: pull request testing
    if: type = pull_request
    script: sbt clean coverage tests/test coverageReport codacyCoverage

  - name: formatting check
    if: type = pull_request
    script: sbt scalafmtCheckAll scalafmtSbtCheck

  - stage: release
    if: ((branch = master AND type = push) OR (tag IS present)) AND NOT fork
    script: sbt ci-release
cache:
  directories:
  - "$HOME/.ivy2/cache"
  - "$HOME/.sbt/boot/"
  - "$HOME/.coursier/cache"
env:
  global:
    secure: AMqWlLIHwLa4ORcOWhwSfWb/vair5aAbvY0gXPgbupLKiSkuzYfktPfwzR4Jw959dCL5kUqYLJXBaspkgPSmVtJ7HPPnehv+r+yOzRWxFD3AATDklGsSR0EsmErwcKrDfzaxAIRZ6yJBR5NkTC/foHMi3h5c9C6/VnOSu7kJwT6HqZ1aGttcj3zE2LBBMgXZQw/d9FN6XxlLo5L0iFA/vxS2NpauXIDJbML7l155dHdQ0jzACCTHWx44OKf5gOiSmxRs+o4l0HJNQCV/yZ3y9+LpWEPINNFOohnhFTZ4Y9+I4xXwMLZPURFCE4EW0+0yew3Ii03sA3t/3i1mhaeIoH8VWEOUqQxNxZsVmuTQ02+3llrZ4v/YXox1tRdKz6FYu38/0xoozQGdNMlHx9LfXIitVUQx5MFmQBXX9W1st4M2yzy7yTSnYEvaIZmG4SDlNbzWvktzXwQRzuVOcW3EPeAVLPjh+1F8C0TZfZgy06ka0qYVDPjq59xtYtu8Gl1QW9tSaTm5MOLcS/aqqKW/ujoh29y2oYiNGuIttaxSz1QeFFZbFk6yR6qTaqhcd6n2AY9Ep+YwBq661RxQeA2vxq5b//bf7BsEiNfszRiU21SE2PJr8YMFv59zLhtA/1jgwkbSUaEMVXFlg1+bWEydjcPSo7PLc/yjJqnDu/hzmIM=
